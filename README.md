# Моделирование рынка при динамическом ценообразовании

***“Не нужно заниматься прогнозированием продаж и складских остатков, нужно заниматься моделированием рынка и оценкой свой доли на нем, так как все остальные показатели лишь вытекают из них” какой-то неизвестный аналитик.***

Объемы продаж в каждый конкретный момент времени зависят от компании лишь на треть, остальные две части: позиция конкурирующих фирм с их ценовой политикой и поведение покупателей. Без учета этих двух факторов любой прогноз на будущий период, основывающийся только на предыдущих продажах, не более чем копирование прошлых периодов. Таким образом, хороший план должен отвечать на три ключевых вопроса: как должна поступить наша компания, как на это отреагируют конкуренты, как это отразиться на покупательской активности.
Приступаем к разработке прототипа модели. Для примера возьмем рынок сыра.
**Шаг 1.** Представим, что у нас нет в распоряжении истории продаж за предыдущие периоды, поэтому мы будем опираться только на данные, которые можно найти на просторах Интернета. Их статистическая точность в данном случае не важна, так как по факту они лишь ориентиры при настройке модели. 
Исходя из среднестатистической нормы потребления сыра в нашей стране рассчитываем общий объем продаж, среднесуточное потребление на одного человека, также формируем структуру реализации по видам продукта.
![Первоначальные расчеты](https://github.com/grishenkovp/project_cheese_market/raw/main/screenshot/consumption_calculation.PNG)
Количество населения не равно количеству покупателей. Зная пропорции распределения одиночек и разных видов семей, можно посчитать приблизительное количество потенциальных покупателей в городе.
Со структурой ритейлеров, которые занимаются продажей сыров, дело обстоит несколько сложнее. Фактический пересчет всех магазинов в городе – дело весьма трудоемкое, но можно руководствоваться процентами, которые занимают федеральные торговые сети во всей стране. Если тот или иной ритейлер отсутствует в конкретном регионе, его долю можно отдать местным магазинам. 
**Шаг 2.** Данные по ценовой политике на предстоящий год можно найти в департаменте маркетинга. Что касается конкурентов, то их цены всегда можно учесть через предполагаемые коэффициенты к нашим значениям.
Данная модель является лишь демонстрацией. За основу были взяты цены декабря 2019 года. Все остальные цены были получены путем умножения базы на ежедневные коэффициенты.
![Установка цен](https://github.com/grishenkovp/project_cheese_market/raw/main/screenshot/setting_prices.PNG)
В рамках моделирования рынка было подготовлено три сценария: все игроки рынка заморозили цены, динамическое изменение цен, все магазины одномоментно повысили цены. Первый и второй сценарии очень мало вероятны в реальной жизни, тем интереснее проиграть данные варианты при моделировании.
**Шаг 3.** Поочередно выбираем каждый из сценариев для формирования сводного прайс-листа на год и выгружаем полученные данные в отдельные файлы csv. 
**Шаг 4.** В самой модели настраиваем стартовые параметры, которые будут влиять на состав рандомных групп, структуру торговых сетей города, диапазон моделирования и т.д. Итоговый алгоритм принятия решения получился довольно медленным, симуляцию рынка пришлось запускать на группах в 150 человек. Промежуток моделирования 2 месяца.
**Шаг 5.** С помощью скриптов Python формируем в БД четыре таблицы (реестр цен, справочник покупателей, свод остатков сыра на балансе у каждого из клиентов и таблица с продажами) и заполняем их стартовыми значениями.
**Шаг 6.** Выбираем один из сценариев для моделирования и запускаем алгоритм принятия решения о покупке товара для каждого клиента в каждый отдельный день периода. В основе принятия решения лежат следующие факторы: данные о пользователе из системы, баланс продукта, предыдущая цена, по которой он приобретал товар, а также текущие цены на рынке.
![Дерево решений](https://github.com/grishenkovp/project_cheese_market/raw/main/screenshot/decision_algorithm.PNG)
**Шаг 7.** Выгружаем полученные записи о продажах из БД и повторяем шаги 5 и 6.
**Шаг 8.** Консолидируем три датасета с данными о продажах для последующей обработки информации на платформе BI.
**Шаг 9.** На интерактивном управленческом отчете пытаемся найти новые инсайты в ценовой политике на предстоящий год.
![Управленческий отчет](https://github.com/grishenkovp/project_cheese_market/raw/main/screenshot/dashboard.PNG)
Оценка такого способа моделирования рынка.
**Плюсы**
- Возможность запуска моделирования даже на холодном старте, то есть не нужны исторические данные
- Возможность видеть в динамике как свою позицию на рынке, так и конкурирующих фирм
- Возможность видеть, как изменение в ценах отражается на объемах продаж (в кг и шт.)
**Минусы**
- Сложность (или невозможность) применения при большой номенклатуре
- Необходимость относительно точного угадывания ценовой политики конкурентов
- Ресурсоемкость выполнения расчетов для большой группа клиентов





